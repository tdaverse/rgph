# rgph

Reeb graphs arise as low-dimensional quotients of topological spaces by
level set–based equivalence. The Reeb graph’s topological structure is
informative of that of the original space but quicker and easier to
compute.

**rgph** provides an S3 class and constructors for Reeb graphs, bindings
to the
[`ReebGraphPairing`](https://github.com/USFDataVisualization/ReebGraphPairing)
Java library for pairing their critical points, post-processing to
extended persistent homology, and methods to accommodate `igraph` and
`network` objects and to streamline the process.

## Installation

You can install the development version of **rgph** from
[GitHub](https://github.com/) with:

``` r
# install.packages("pak")
pak::pak("tdaverse/rgph")
```

We expect to submit to CRAN soon!

## Example

``` r
library(rgph)
#> Loading required package: rJava
#> Loading required package: phutil
```

The running example from [Tu, Hajij, and Rosen
(2019)](https://doi.org/10.1007/978-3-030-33720-9_8) can be read in from
an installed data file:

``` r
( ex_file <- system.file("extdata/running_example.txt", package = "rgph") )
#> [1] "/Library/Frameworks/R.framework/Versions/4.2/Resources/library/rgph/extdata/running_example.txt"
( ex_reeb <- read_reeb_graph(ex_file) )
#> Reeb graph with 16 vertices and 18 edges on [0,15]:
#>  1 ( 0) --  3 ( 2)
#>  2 ( 1) --  3 ( 2)
#>  3 ( 2) --  4 ( 3)
#>  4 ( 3) --  6 ( 5)
#>  4 ( 3) --  7 ( 6)
#>  5 ( 4) --  7 ( 6)
#>  6 ( 5) -- 10 ( 9)
#>  6 ( 5) -- 10 ( 9)
#>  7 ( 6) -- 12 (11)
#>  8 ( 7) --  9 ( 8)
#>  9 ( 8) -- 12 (11)
#>  9 ( 8) -- 11 (10)
#> ...
```

The Reeb graph printout comprises the edgelist. In this example, the
function value at each vertex is (up to numbering convention) the index
of that vertex. The R indexing starts at 1, while the function values,
printed in parentheses, reflect the original indexing from 0.

While no [`plot()`](https://rdrr.io/r/graphics/plot.default.html) method
is provided yet, a layered layout from
[**igraph**](https://r.igraph.org/) may be helpful. Here we negate the
values of the Reeb function so that vertices with higher (original)
values are positioned higher in the plot:

``` r
ex_igraph <- as_igraph(ex_reeb, values = "depth")
ex_layout <- igraph::layout_with_sugiyama(
  ex_igraph,
  layers = -igraph::vertex_attr(ex_igraph, "depth")
)
plot(ex_igraph, layout = ex_layout)
```

![](reference/figures/README-plot-example-1.png)

While low-dimensional, Reeb graphs are intricate structures, whereas
most statistical applications require numerical summary statistics. A
meaningful topological signature of a Reeb graph (hence of its parent
space) can be obtained by pairing its critical points.

Tu, Hajij, and Rosen proposed a clever single-pass algorithm,
“propagate-and-pair”, which outperformed a multiple-pass algorithm
(based on standard procedures at the time) on most Reeb graphs included
in a comparison. Both methods are provided, which the user may control
using the `method` argument:

``` r
( ex_pairs <- reeb_graph_pairs(ex_reeb, method = "single") )
#> Reeb graph critical pairing (8 pairs):
#>  1 ( 0) •- ... -• 16 (15)
#>  2 ( 1) •- ... >-  3 ( 2)
#>  5 ( 4) •- ... >-  7 ( 6)
#>  8 ( 7) •- ... >- 11 (10)
#>  6 ( 5) -< ... >- 10 ( 9)
#>  4 ( 3) -< ... >- 12 (11)
#>  9 ( 8) -< ... >- 13 (12)
#> 14 (13) -< ... -• 15 (14)
```

Each end of a pairing is either a local extremum (minimum or maximum) or
a fork (upward or downward). These types are indicated in the printout
by bullets and inequality signs, respectively; refer to the plot above
to see how the pairings exhaust the vertex–edge incidences.

The pairing output can be converted to extended persistence diagrams
using the `persistence` class from
[**phutil**](https://tdaverse.github.io/phutil/) and plotted using the
`diagram` method from [**TDA**](https://github.com/compTAG/r-tda):

``` r
( ex_ph <- reeb_graph_persistence(ex_pairs, scale = "index") )
#> 
#> ── Persistence Data ────────────────────────────────────────────────────────────
#> ℹ There are 4 and 4 pairs in dimensions 0 and 1 respectively.
#> ℹ Computed from a Extended Reeb (Sublevel) filtration using `rgph::reeb_graph_persistence()`.
#> ℹ With the following parameters: method = 'single_pass' and scale = 'index'.
TDA::plot.diagram(as.data.frame(ex_ph), asp = 1)
```

![](reference/figures/README-persist-example-1.png)

The plot overlays 4 sub-diagrams, two of which lie below the diagonal
because they encode features in extended persistence whose births occur
at larger function values than their deaths (explained in detail by
[Carrière & Oudot (2018)](https://doi.org/10.1007/s10208-017-9370-z);
compare to Fig. 1 of Tu, Hajij, and Rosen):

- min–max pairs that encode connected components, constitutive of
  degree-\\(0\\) positive extended persistence; the pair \\((1,16)\\)
- min–down pairs that encode merges, in degree-\\(0\\) ordinary
  persistence; e.g. the pair \\((5,7)\\)
- up–max pairs that encode splits, in degree-\\(1\\) relative
  persistence; the pair \\((15,14)\\)
- up–down pairs that encode cycles, in degree-\\(1\\) negative extended
  persistence; e.g. the pair \\((13,9)\\)

# Package index

## ‘rgph’ package

Compute critical point pairings and persistent homology for Reeb graphs

- [`rgph-package`](rgph.md) [`rgph`](rgph.md) : rgph: Pair Critical
  Points and Compute Persistent Homology of Reeb Graphs

## Data sets

Example Reeb graphs used to illustrate package tools

- [`david`](reeb_graph_examples.md) [`buddha`](reeb_graph_examples.md)
  [`topology`](reeb_graph_examples.md)
  [`flower`](reeb_graph_examples.md) : Mesh-Derived Reeb Graphs

## Class and coercers

An S3 class for Reeb graphs and converters with other graph classes

- [`reeb_graph()`](reeb_graph.md)
  [`print(`*`<reeb_graph>`*`)`](reeb_graph.md)
  [`format(`*`<reeb_graph>`*`)`](reeb_graph.md)
  [`read_reeb_graph()`](reeb_graph.md) : An S3 class and constructors
  for Reeb graphs

- [`as_reeb_graph()`](as_reeb_graph.md)
  [`as_igraph()`](as_reeb_graph.md) [`as_network()`](as_reeb_graph.md) :

  Coerce objects to class `reeb_graph`

## Statistical summaries

Critical point pairings and persistent homology

- [`reeb_graph_pairs()`](reeb_graph_pairs.md)
  [`as.data.frame(`*`<reeb_graph_pairs>`*`)`](reeb_graph_pairs.md)
  [`print(`*`<reeb_graph_pairs>`*`)`](reeb_graph_pairs.md)
  [`format(`*`<reeb_graph_pairs>`*`)`](reeb_graph_pairs.md) : Pair Reeb
  Graph Critical Points via Java
- [`reeb_graph_persistence()`](reeb_graph_persistence.md) : Compute
  Extended Persistent Homology of a Reeb Graph

# Articles

### All vignettes

- [Runtime Comparison of Critical Point Pairing
  Algorithms](benchmark.md):
