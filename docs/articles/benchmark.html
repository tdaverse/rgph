<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Runtime Comparison of Critical Point Pairing Algorithms • rgph</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Runtime Comparison of Critical Point Pairing Algorithms">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rgph</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/benchmark.html">Runtime Comparison of Critical Point Pairing Algorithms</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Runtime Comparison of Critical Point Pairing
Algorithms</h1>
            
      

      <div class="hidden name"><code>benchmark.Rmd</code></div>

    </div>

    
    
<p>This vignette compares the runtimes and memory allocations of the
multi-pass and single-pass algorithms for pairing critical points.
Several tidyverse packages are used to post-process the benchmark
results:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">rgph</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: package 'tidyr' was built under R version 4.5.2</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: package 'ggplot2' was built under R version 4.5.2</span></span></code></pre></div>
<div class="section level2">
<h2 id="the-running-example">The running example<a class="anchor" aria-label="anchor" href="#the-running-example"></a>
</h2>
<p>To illustrate, compare the results of the two algorithms on the
running example from Tu &amp;al (2018):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"running_example.txt"</span>, package <span class="op">=</span> <span class="st">"rgph"</span><span class="op">)</span></span>
<span><span class="va">ex_reeb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reeb_graph.html">read_reeb_graph</a></span><span class="op">(</span><span class="va">ex_file</span><span class="op">)</span></span>
<span><span class="op">(</span> <span class="va">ex_multi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reeb_graph_pairs.html">reeb_graph_pairs</a></span><span class="op">(</span><span class="va">ex_reeb</span>, method <span class="op">=</span> <span class="st">"multi_pass"</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="co">#&gt; Reeb graph critical pairing (8 pairs):</span></span>
<span><span class="co">#&gt;  1 ( 0) •- ... -• 16 (15)</span></span>
<span><span class="co">#&gt;  2 ( 1) •- ... &gt;-  3 ( 2)</span></span>
<span><span class="co">#&gt;  5 ( 4) •- ... &gt;-  7 ( 6)</span></span>
<span><span class="co">#&gt;  8 ( 7) •- ... &gt;- 11 (10)</span></span>
<span><span class="co">#&gt;  6 ( 5) -&lt; ... &gt;- 10 ( 9)</span></span>
<span><span class="co">#&gt;  4 ( 3) -&lt; ... &gt;- 12 (11)</span></span>
<span><span class="co">#&gt;  9 ( 8) -&lt; ... &gt;- 13 (12)</span></span>
<span><span class="co">#&gt; 14 (13) -&lt; ... -• 15 (14)</span></span>
<span><span class="op">(</span> <span class="va">ex_single</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reeb_graph_pairs.html">reeb_graph_pairs</a></span><span class="op">(</span><span class="va">ex_reeb</span>, method <span class="op">=</span> <span class="st">"single_pass"</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="co">#&gt; Reeb graph critical pairing (8 pairs):</span></span>
<span><span class="co">#&gt;  1 ( 0) •- ... -• 16 (15)</span></span>
<span><span class="co">#&gt;  2 ( 1) •- ... &gt;-  3 ( 2)</span></span>
<span><span class="co">#&gt;  5 ( 4) •- ... &gt;-  7 ( 6)</span></span>
<span><span class="co">#&gt;  8 ( 7) •- ... &gt;- 11 (10)</span></span>
<span><span class="co">#&gt;  6 ( 5) -&lt; ... &gt;- 10 ( 9)</span></span>
<span><span class="co">#&gt;  4 ( 3) -&lt; ... &gt;- 12 (11)</span></span>
<span><span class="co">#&gt;  9 ( 8) -&lt; ... &gt;- 13 (12)</span></span>
<span><span class="co">#&gt; 14 (13) -&lt; ... -• 15 (14)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">ex_multi</span>, <span class="va">ex_single</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Attributes: &lt; Component \"elapsed_time\": Mean relative difference: 0.6533532 &gt;"</span></span>
<span><span class="co">#&gt; [2] "Attributes: &lt; Component \"method\": 1 string mismatch &gt;"</span></span></code></pre></div>
<p>We expect the resulting data frames to be equivalent, but the output
contains the attributes <code>method</code> and
<code>elapsed_time</code> that we expect to be different. If we ignore
attributes, then we find the results to agree:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">ex_multi</span>, <span class="va">ex_single</span>, check.attributes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>For this reason, we omit the default check in the benchmarking
run:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">bench</span><span class="fu">::</span><span class="fu"><a href="https://bench.r-lib.org/reference/mark.html" class="external-link">mark</a></span><span class="op">(</span></span>
<span>  multi <span class="op">=</span> <span class="fu"><a href="../reference/reeb_graph_pairs.html">reeb_graph_pairs</a></span><span class="op">(</span><span class="va">ex_reeb</span>, method <span class="op">=</span> <span class="st">"multi_pass"</span><span class="op">)</span>,</span>
<span>  single <span class="op">=</span> <span class="fu"><a href="../reference/reeb_graph_pairs.html">reeb_graph_pairs</a></span><span class="op">(</span><span class="va">ex_reeb</span>, method <span class="op">=</span> <span class="st">"single_pass"</span><span class="op">)</span>,</span>
<span>  check <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 6</span></span></span>
<span><span class="co">#&gt;   expression      min   median `itr/sec` mem_alloc `gc/sec`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;bch:expr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;bch:tm&gt;</span> <span style="color: #949494; font-style: italic;">&lt;bch:tm&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;bch:byt&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> multi         280µs    296µs     <span style="text-decoration: underline;">3</span>165.    1.24KB     12.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> single        255µs    276µs     <span style="text-decoration: underline;">3</span>524.    1.24KB     14.7</span></span></code></pre></div>
<p>The R bindings are equivalent; while total runtimes will be higher
than when comparing the Java programs directly, the differences between
them should be the same. Indeed, the allocated memory is exactly the
same. However, the single-pass algorithm—Propagate and Pair—is a
marginal improvement over the multiple-pass merge pairing algorithm.</p>
</div>
<div class="section level2">
<h2 id="a-more-complex-case">A more complex case<a class="anchor" aria-label="anchor" href="#a-more-complex-case"></a>
</h2>
<p>The exported object <code>flower</code> is a <code>reeb_graph</code>
constructed from the flower mesh, one of 12 from the
<code>AIM@SHAPE</code> collection used by Tu &amp;al to benchmark
algorithms. Among them, it contains the most critical points, so it will
better illustrate the difference between the algorithms in
computationally intensive settings.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print only a few edges for illustration</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">flower</span>, n <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reeb graph with 325 vertices and 388 edges on [0,10]:</span></span>
<span><span class="co">#&gt;  65 (0.000000) -- 283 (1.237770)</span></span>
<span><span class="co">#&gt; 283 (1.237770) --  73 (2.475540)</span></span>
<span><span class="co">#&gt;  73 (2.475540) -- 240 (3.026665)</span></span>
<span><span class="co">#&gt; 240 (3.026665) --  64 (3.577791)</span></span>
<span><span class="co">#&gt; ...</span></span></code></pre></div>
<p>However, this Reeb graph contains isolated vertices, which contribute
no positive-persistent features to the output but must be dropped before
calculation, lest they seize up the algorithms:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print only a few pairs for illustration</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../reference/reeb_graph_pairs.html">reeb_graph_pairs</a></span><span class="op">(</span><span class="va">flower</span>, method <span class="op">=</span> <span class="st">"multi_pass"</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; Note: 87 isolated vertices were dropped.</span></span>
<span><span class="co">#&gt; Reeb graph critical pairing (200 pairs):</span></span>
<span><span class="co">#&gt;  65 (0.000000) •- ... -• 66 (10.000000)</span></span>
<span><span class="co">#&gt;  73 (2.475540) -&lt; ... &gt;- 64 ( 3.577791)</span></span>
<span><span class="co">#&gt; 188 (3.776078) -&lt; ... &gt;- 48 ( 3.824975)</span></span>
<span><span class="co">#&gt; 144 (3.812326) -&lt; ... &gt;- 94 ( 3.872892)</span></span></code></pre></div>
<p>So that the benchmark results are more reflective of the algorithms’
requirements, we manually drop these points first:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flower</span> <span class="op">&lt;-</span> <span class="fu">rgph</span><span class="fu">:::</span><span class="fu">drop_reeb_graph_points</span><span class="op">(</span><span class="va">flower</span><span class="op">)</span></span>
<span><span class="co">#&gt; Note: 87 isolated vertices were dropped.</span></span>
<span><span class="fu">bench</span><span class="fu">::</span><span class="fu"><a href="https://bench.r-lib.org/reference/mark.html" class="external-link">mark</a></span><span class="op">(</span></span>
<span>  multi <span class="op">=</span> <span class="fu"><a href="../reference/reeb_graph_pairs.html">reeb_graph_pairs</a></span><span class="op">(</span><span class="va">flower</span>, method <span class="op">=</span> <span class="st">"multi_pass"</span><span class="op">)</span>,</span>
<span>  single <span class="op">=</span> <span class="fu"><a href="../reference/reeb_graph_pairs.html">reeb_graph_pairs</a></span><span class="op">(</span><span class="va">flower</span>, method <span class="op">=</span> <span class="st">"single_pass"</span><span class="op">)</span>,</span>
<span>  check <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 6</span></span></span>
<span><span class="co">#&gt;   expression      min   median `itr/sec` mem_alloc `gc/sec`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;bch:expr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;bch:tm&gt;</span> <span style="color: #949494; font-style: italic;">&lt;bch:tm&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;bch:byt&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> multi         4.7ms   4.91ms     197.     52.8KB     2.03</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> single         13ms  16.89ms      62.8    52.8KB     0</span></span></code></pre></div>
<p>For this Reeb graph, Propagate and Pair outperforms the multi-pass
algorithm by roughly a factor of 3.</p>
</div>
<div class="section level2">
<h2 id="how-performance-and-improvement-scale">How performance and improvement scale<a class="anchor" aria-label="anchor" href="#how-performance-and-improvement-scale"></a>
</h2>
<p>Finally, we compare how both algorithms scale. Vertex and edge data
are provided for three random merge tree Reeb graphs on an exponential
size scale. These are converted to split trees by negating the vertex
values and benchmarked separately before being stacked. (Note that the
single-pass algorithm was found superior to the multi-pass algorithm on
split trees but inferior on merge trees.)</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># collect split tree Reeb graphs</span></span>
<span><span class="va">tree_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    `10` <span class="op">=</span> <span class="st">"10_tree_iterations.txt"</span>,</span>
<span>    `100` <span class="op">=</span> <span class="st">"100_tree_iterations.txt"</span>,</span>
<span>    `1000` <span class="op">=</span> <span class="st">"1000_tree_iterations.txt"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">f</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="va">f</span>, package <span class="op">=</span> <span class="st">"rgph"</span><span class="op">)</span>,</span>
<span>  <span class="st">""</span></span>
<span><span class="op">)</span></span>
<span><span class="va">tree_reebs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">tree_files</span>, <span class="va">read_reeb_graph</span><span class="op">)</span></span>
<span><span class="va">tree_reebs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">tree_reebs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">rg</span><span class="op">)</span> <span class="op">{</span> <span class="va">rg</span><span class="op">$</span><span class="va">values</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">rg</span><span class="op">$</span><span class="va">values</span>; <span class="va">rg</span> <span class="op">}</span><span class="op">)</span></span>
<span><span class="co"># aggregate benchmark comparisons</span></span>
<span><span class="va">tree_bench</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">tree_reebs</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">bm</span> <span class="op">&lt;-</span> <span class="fu">bench</span><span class="fu">::</span><span class="fu"><a href="https://bench.r-lib.org/reference/mark.html" class="external-link">mark</a></span><span class="op">(</span></span>
<span>    multi <span class="op">=</span> <span class="fu"><a href="../reference/reeb_graph_pairs.html">reeb_graph_pairs</a></span><span class="op">(</span><span class="va">tree_reebs</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, method <span class="op">=</span> <span class="st">"multi_pass"</span><span class="op">)</span>,</span>
<span>    single <span class="op">=</span> <span class="fu"><a href="../reference/reeb_graph_pairs.html">reeb_graph_pairs</a></span><span class="op">(</span><span class="va">tree_reebs</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, method <span class="op">=</span> <span class="st">"single_pass"</span><span class="op">)</span>,</span>
<span>    check <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">bm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/transmute.html" class="external-link">transmute</a></span><span class="op">(</span></span>
<span>    <span class="va">bm</span>,</span>
<span>    method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">expression</span><span class="op">)</span>,</span>
<span>    <span class="va">n_itr</span>, <span class="va">time</span>, <span class="va">memory</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">bm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">bm</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tree_files</span><span class="op">)</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, <span class="va">size</span><span class="op">)</span></span>
<span>  <span class="va">tree_bench</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">tree_bench</span>, <span class="va">bm</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>By plotting all of the run times from each of the benchmarks, we can
visualize both the differences in runtimes between the algorithms and
the variability in those runtimes.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot runtime results</span></span>
<span><span class="va">tree_bench</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">size</span>, <span class="va">method</span>, <span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">time</span> <span class="op">*</span> <span class="fl">1e3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">method</span>, shape <span class="op">=</span> <span class="va">method</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    transform <span class="op">=</span> <span class="st">"log1p"</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html" class="external-link">label_number</a></span><span class="op">(</span>suffix <span class="op">=</span> <span class="st">"ms"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"tree size"</span>, y <span class="op">=</span> <span class="st">"run time"</span><span class="op">)</span></span></code></pre></div>
<p><img src="benchmark_files/figure-html/random%20(split)%20trees%20plot-1.png" class="r-plt" alt="" width="100%"></p>
<p>The single-pass advantage appears to grow with size. The ratio of
medians quantifies this:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree_bench</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/transmute.html" class="external-link">transmute</a></span><span class="op">(</span><span class="va">size</span>, <span class="va">method</span>, median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">median</span>, <span class="fl">0.</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>id_cols <span class="op">=</span> <span class="va">size</span>, names_from <span class="op">=</span> <span class="va">method</span>, values_from <span class="op">=</span> <span class="va">median</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/transmute.html" class="external-link">transmute</a></span><span class="op">(</span><span class="va">size</span>, ratio <span class="op">=</span> <span class="va">single</span> <span class="op">/</span> <span class="va">multi</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 2</span></span></span>
<span><span class="co">#&gt;    size ratio</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>    10 0.933</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>   100 0.737</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">1</span>000 0.657</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Satyajit Mohanty, Shubham Singh, Jason Cory Brunson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
